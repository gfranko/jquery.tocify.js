/*! jquery.tocify - v1.9.0 - 2013-10-01 
* http://gregfranko.com/jquery.tocify.js/
* Copyright (c) 2013 Greg Franko; Licensed MIT*/
(function(n){"use strict";n(window.jQuery,window,document)})(function(n,t,i){"use strict";var s="tocify",p="."+s,a="tocify-focus",v="tocify-hover",h="tocify-hide",w="."+h,e="tocify-header",u="."+e,c="tocify-subheader",r="."+c,l="tocify-item",f="."+l,o="tocify-extend-page",y="."+o;n.widget("toc.tocify",{version:"1.9.0",options:{context:"body",ignoreSelector:null,selectors:"h1, h2, h3",showAndHide:!0,showEffect:"slideDown",showEffectSpeed:"medium",hideEffect:"slideUp",hideEffectSpeed:"medium",smoothScroll:!0,smoothScrollSpeed:"medium",scrollTo:0,showAndHideOnScroll:!0,highlightOnScroll:!0,highlightOffset:40,theme:"bootstrap",extendPage:!0,extendPageOffset:100,history:!0,scrollHistory:!1,hashGenerator:"compact",highlightDefault:!0},_create:function(){var i=this;i.extendPageScroll=!0;i.items=[];i._generateToc();i._addCSSClasses();i.webkit=function(){for(var n in t)if(n&&n.toLowerCase().indexOf("webkit")!==-1)return!0;return!1}();i._setEventHandlers();n(t).load(function(){i._setActiveElement(!0);n("html, body").promise().done(function(){setTimeout(function(){i.extendPageScroll=!1},0)})})},_generateToc:function(){var t=this,r,i,u=t.options.ignoreSelector;if(r=this.options.selectors.indexOf(",")!==-1?n(this.options.context).find(this.options.selectors.replace(/ /g,"").substr(0,this.options.selectors.indexOf(","))):n(this.options.context).find(this.options.selectors.replace(/ /g,"")),!r.length){t.element.addClass(h);return}t.element.addClass(s);r.each(function(r){n(this).is(u)||(i=n("<ul/>",{id:e+r,"class":e}).append(t._nestElements(n(this),r)),t.element.append(i),n(this).nextUntil(this.nodeName.toLowerCase()).each(function(){n(this).find(t.options.selectors).length===0?n(this).filter(t.options.selectors).each(function(){n(this).is(u)||t._appendSubheaders.call(this,t,i)}):n(this).find(t.options.selectors).each(function(){n(this).is(u)||t._appendSubheaders.call(this,t,i)})}))})},_setActiveElement:function(n){var i=this,r=t.location.hash.substring(1),u=i.element.find('li[data-unique="'+r+'"]');return r.length?(i.element.find("."+i.focusClass).removeClass(i.focusClass),u.addClass(i.focusClass),i.options.showAndHide&&u.click()):(i.element.find("."+i.focusClass).removeClass(i.focusClass),!r.length&&n&&i.options.highlightDefault&&i.element.find(f).first().addClass(i.focusClass)),i},_nestElements:function(t,i){var u,f,r;return u=n.grep(this.items,function(n){return n===t.text()}),u.length?this.items.push(t.text()+i):this.items.push(t.text()),r=this._generateHashValue(u,t,i),f=n("<li/>",{"class":l,"data-unique":r}).append(n("<a/>",{text:t.text()})),t.before(n("<div/>",{name:r,"data-unique":r})),f},_generateHashValue:function(n,t,i){var r="",u=this.options.hashGenerator;if(u==="pretty"){for(r=t.text().toLowerCase().replace(/\s/g,"-");r.indexOf("--")>-1;)r=r.replace(/--/g,"-");while(r.indexOf(":-")>-1)r=r.replace(/:-/g,"-")}else r=typeof u=="function"?u(t.text(),t):t.text().replace(/\s/g,"");return n.length&&(r+=""+i),r},_appendSubheaders:function(t,i){var u=n(this).index(t.options.selectors),s=n(t.options.selectors).eq(u-1),e=+n(this).prop("tagName").charAt(1),o=+s.prop("tagName").charAt(1);e<o?t.element.find(r+"[data-tag="+e+"]").last().append(t._nestElements(n(this),u)):e===o?i.find(f).last().after(t._nestElements(n(this),u)):i.find(f).last().after(n("<ul/>",{"class":c,"data-tag":e})).next(r).append(t._nestElements(n(this),u))},_setEventHandlers:function(){var r=this;this.element.on("click.tocify","li",function(){if(r.options.history&&(t.location.hash=n(this).attr("data-unique")),r.element.find("."+r.focusClass).removeClass(r.focusClass),n(this).addClass(r.focusClass),r.options.showAndHide){var i=n('li[data-unique="'+n(this).attr("data-unique")+'"]');r._triggerShow(i)}r._scrollTo(n(this))});this.element.find("li").on({"mouseenter.tocify":function(){n(this).addClass(r.hoverClass);n(this).css("cursor","pointer")},"mouseleave.tocify":function(){r.options.theme!=="bootstrap"&&n(this).removeClass(r.hoverClass)}});if(r.options.extendPage||r.options.highlightOnScroll||r.options.scrollHistory||r.options.showAndHideOnScroll)n(t).on("scroll.tocify",function(){n("html, body").promise().done(function(){var u=n(t).scrollTop(),h=n(t).height(),a=n(i).height(),v=n("body")[0].scrollHeight,e,s,c,l;if(r.options.extendPage&&(r.webkit&&u>=v-h-r.options.extendPageOffset||!r.webkit&&h+u>a-r.options.extendPageOffset)&&!n(y).length){if(s=n('div[data-unique="'+n(f).last().attr("data-unique")+'"]'),!s.length)return;c=s.offset().top;n(r.options.context).append(n("<div />",{"class":o,height:Math.abs(c-u)+"px","data-unique":o}));r.extendPageScroll&&(l=r.element.find("li.active"),r._scrollTo(n('div[data-unique="'+l.attr("data-unique")+'"]')))}setTimeout(function(){var f=null,o=null,s=n(r.options.context).find("div[data-unique]"),i;s.each(function(t){var i=Math.abs((n(this).next().length?n(this).next():n(this)).offset().top-u-r.options.highlightOffset);if(f==null||i<f)f=i,o=t;else return!1});i=n(s[o]).attr("data-unique");e=n('li[data-unique="'+i+'"]');r.options.highlightOnScroll&&e.length&&(r.element.find("."+r.focusClass).removeClass(r.focusClass),e.addClass(r.focusClass));r.options.scrollHistory&&t.location.hash!=="#"+i&&t.location.replace("#"+i);r.options.showAndHideOnScroll&&r.options.showAndHide&&r._triggerShow(e,!0)},0)})})},show:function(t){var i=this,f=t;if(!t.is(":visible")){t.find(r).length||t.parent().is(u)||t.parent().is(":visible")?t.children(r).length||t.parent().is(u)||(t=t.closest(r)):t=t.parents(r).add(t);switch(i.options.showEffect){case"none":t.show();break;case"show":t.show(i.options.showEffectSpeed);break;case"slideDown":t.slideDown(i.options.showEffectSpeed);break;case"fadeIn":t.fadeIn(i.options.showEffectSpeed);break;default:t.show()}}return t.parent().is(u)?i.hide(n(r).not(t)):i.hide(n(r).not(t.closest(u).find(r).not(t.siblings()))),i},hide:function(n){var t=this;switch(t.options.hideEffect){case"none":n.hide();break;case"hide":n.hide(t.options.hideEffectSpeed);break;case"slideUp":n.slideUp(t.options.hideEffectSpeed);break;case"fadeOut":n.fadeOut(t.options.hideEffectSpeed);break;default:n.hide()}return t},_triggerShow:function(n,t){var i=this;return n.parent().is(u)||n.next().is(r)?i.show(n.next(r),t):n.parent().is(r)&&i.show(n.parent(),t),i},_addCSSClasses:function(){return this.options.theme==="jqueryui"?(this.focusClass="ui-state-default",this.hoverClass="ui-state-hover",this.element.addClass("ui-widget").find(".toc-title").addClass("ui-widget-header").end().find("li").addClass("ui-widget-content")):this.options.theme==="bootstrap"?(this.element.find(u+","+r).addClass("nav nav-list"),this.focusClass="active"):(this.focusClass=a,this.hoverClass=v),this},setOption:function(){n.Widget.prototype._setOption.apply(this,arguments)},setOptions:function(){n.Widget.prototype._setOptions.apply(this,arguments)},_scrollTo:function(t){var i=this,f=i.options.smoothScroll||0,r=i.options.scrollTo,u=n('div[data-unique="'+t.attr("data-unique")+'"]');return u.length?(n("html, body").promise().done(function(){n("html, body").animate({scrollTop:u.offset().top-(n.isFunction(r)?r.call():r)+"px"},{duration:f}).promise().done(function(){u.trigger("tocify.scrollEnd")})}),i):i}})});
